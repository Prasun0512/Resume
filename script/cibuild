#!/usr/bin/env bash
set -euo pipefail

# Build the site
bundle exec jekyll build --trace

# Link & HTML checks (CI-friendly)
bundle exec htmlproofer ./_site \
  --check-html \
  --check-sri \
  --assume-extension \
  --http-status-ignore "999,403,429" \
  --url-ignore "https://www.linkedin.com/in/prasun-kumar-1708/" \
  --file-ignore "./_site/another-page.html" \
  --url-swap "^/Resume/:/" \
  --typhoeus-config '{"timeout":20,"connecttimeout":10,"followlocation":true}'


# RuboCop (fail on errors; warnings ok if you want stricter: remove --fail-level)
bundle exec rubocop -D --fail-level E --config .rubocop.yml

# Extra HTML validation (now robust)
bundle exec script/validate-html

# Build the gem (if present)
gem build jekyll-theme-minimal.gemspec
